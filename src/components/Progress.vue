<template>
  <div id="progressbar-container" class="container is-flex is-centered-flex">
    <div
      id="progressBar"
      data-path="M26.84,29.52v5.58c0,0.89,0.32,1.64,0.95,2.26c0.63,0.62,1.4,0.93,2.3,0.93h36.6c0.9,0,1.67,0.31,2.3,0.94
 c0.63,0.63,0.95,1.39,0.95,2.28v18.81c0,0.9-0.32,1.66-0.95,2.28c-0.63,0.63-1.4,0.94-2.3,0.94H30.1c-0.9,0-1.67,0.31-2.3,0.94
 c-0.63,0.63-0.95,1.39-0.95,2.28v29.69c0,0.9-0.32,1.66-0.94,2.28c-0.63,0.63-1.39,0.94-2.29,0.94H3.24c-0.9,0-1.66-0.31-2.29-0.94
 C0.31,98.11,0,97.35,0,96.46V4.57c0-0.89,0.31-1.66,0.94-2.28c0.63-0.63,1.39-0.94,2.29-0.94h68.88c0.9,0,1.67,0.32,2.3,0.95
 c0.63,0.63,0.95,1.4,0.95,2.29v18.5c0,0.9-0.32,1.67-0.95,2.3c-0.63,0.63-1.4,0.94-2.3,0.94H30.1c-0.9,0-1.67,0.31-2.3,0.93
 C27.16,27.88,26.84,28.63,26.84,29.52z M113.21,99.68H92.84c-0.99,0-1.78-0.31-2.36-0.94c-0.58-0.63-0.88-1.39-0.88-2.28V4.7
 c0-0.89,0.29-1.66,0.88-2.28c0.58-0.63,1.37-0.94,2.36-0.94h20.37c0.9,0,1.66,0.31,2.29,0.94c0.63,0.63,0.94,1.39,0.94,2.28v91.75
 c0,0.9-0.32,1.66-0.94,2.28C114.88,99.37,114.11,99.68,113.21,99.68z M227.88,4.57v91.89c0,0.9-0.32,1.66-0.95,2.28
 c-0.63,0.63-1.4,0.94-2.3,0.94h-20.02c-0.9,0-1.85-0.27-2.84-0.81c-0.99-0.54-1.76-1.16-2.3-1.88l-35.31-49.3
 c-0.54-0.72-1.11-1.01-1.69-0.87c-0.59,0.13-0.88,0.65-0.88,1.54v48.09c0,0.9-0.32,1.66-0.96,2.28c-0.64,0.63-1.41,0.94-2.32,0.94
 h-20.3c-0.91,0-1.68-0.31-2.32-0.94c-0.64-0.63-0.95-1.39-0.95-2.28V4.57c0-0.89,0.32-1.66,0.95-2.28c0.63-0.63,1.4-0.94,2.3-0.94
 h20.33c0.9,0,1.85,0.25,2.85,0.74c0.99,0.49,1.76,1.1,2.3,1.81l35.25,49.3c0.54,0.72,1.11,1.03,1.69,0.94
 c0.59-0.09,0.88-0.58,0.88-1.48V4.57c0-0.89,0.32-1.66,0.95-2.28c0.63-0.63,1.4-0.94,2.3-0.94h20.06c0.9,0,1.67,0.31,2.3,0.94
 C227.57,2.91,227.88,3.67,227.88,4.57z M272.91,99.68h-20.37c-0.99,0-1.78-0.31-2.36-0.94c-0.58-0.63-0.88-1.39-0.88-2.28V4.7
 c0-0.89,0.29-1.66,0.88-2.28c0.58-0.63,1.37-0.94,2.36-0.94h20.37c0.9,0,1.66,0.31,2.29,0.94c0.63,0.63,0.94,1.39,0.94,2.28v91.75
 c0,0.9-0.32,1.66-0.94,2.28C274.57,99.37,273.81,99.68,272.91,99.68z M305.56,65.96c4.88,3.14,9.71,5.6,14.51,7.39
 c4.79,1.79,9.26,2.69,13.42,2.69c3.98,0,7-0.56,9.08-1.68c2.08-1.12,3.12-2.8,3.12-5.04c0-1.16-0.45-2.08-1.36-2.75
 c-0.9-0.67-2.1-1.23-3.59-1.68c-1.49-0.45-3.23-0.81-5.22-1.08c-1.99-0.27-4.02-0.63-6.1-1.07c-1.99-0.36-4.32-0.78-6.98-1.28
 c-2.67-0.49-5.4-1.21-8.2-2.15c-2.8-0.94-5.58-2.13-8.34-3.56c-2.76-1.43-5.22-3.27-7.39-5.51c-2.17-2.24-3.91-4.9-5.22-7.99
 c-1.31-3.09-1.97-6.74-1.97-10.95c0-6.18,1.22-11.28,3.66-15.31s5.53-7.23,9.29-9.61c3.75-2.37,7.93-4.03,12.54-4.97
 C321.42,0.47,325.9,0,330.23,0c7.59,0,14.39,1.1,20.4,3.29c6.01,2.2,11.77,5.4,17.28,9.61c0.72,0.63,1.13,1.39,1.22,2.28
 c0.09,0.9-0.14,1.7-0.68,2.42l-10.57,14.91c-0.54,0.72-1.27,1.16-2.17,1.34c-0.9,0.18-1.72,0-2.44-0.54
 c-4.61-2.87-8.9-4.9-12.88-6.11c-3.98-1.21-7.64-1.81-10.98-1.81c-1,0-2.15,0.02-3.46,0.07c-1.31,0.05-2.55,0.22-3.73,0.54
 c-1.18,0.31-2.15,0.83-2.91,1.54c-0.77,0.72-1.15,1.7-1.15,2.96c0,1.26,0.95,2.37,2.85,3.36c1.9,0.99,4.07,1.84,6.51,2.55
 c2.44,0.72,4.79,1.28,7.05,1.68c2.26,0.4,3.7,0.65,4.34,0.74c3.25,0.63,6.82,1.55,10.71,2.75c3.88,1.21,7.52,3,10.91,5.37
 c3.39,2.37,6.24,5.46,8.54,9.27c2.3,3.81,3.46,8.58,3.46,14.31c0,5.37-0.95,10.01-2.85,13.9c-1.9,3.9-4.54,7.1-7.93,9.6
 c-3.39,2.51-7.46,4.37-12.2,5.58c-4.74,1.21-10.01,1.81-15.79,1.81c-4.7,0-9.08-0.38-13.15-1.14c-4.07-0.76-7.86-1.81-11.39-3.16
 c-3.52-1.34-6.8-2.93-9.83-4.77c-3.03-1.83-5.81-3.78-8.34-5.84c-0.72-0.54-1.13-1.28-1.22-2.22c-0.09-0.94,0.14-1.77,0.68-2.49
 l10.44-14.91c0.54-0.72,1.26-1.16,2.17-1.34C304.02,65.38,304.84,65.51,305.56,65.96z M474.88,4.57v91.89c0,0.9-0.32,1.66-0.95,2.28
 c-0.63,0.63-1.4,0.94-2.3,0.94h-20.33c-1,0-1.79-0.31-2.37-0.94c-0.59-0.63-0.88-1.39-0.88-2.28V67.71c0-0.89-0.32-1.66-0.94-2.28
 c-0.63-0.63-1.4-0.94-2.3-0.94h-27.82c-0.99,0-1.78,0.31-2.36,0.94c-0.58,0.63-0.88,1.39-0.88,2.28v28.75c0,0.9-0.32,1.66-0.96,2.28
 c-0.64,0.63-1.41,0.94-2.32,0.94h-20.3c-1,0-1.8-0.31-2.39-0.94c-0.59-0.63-0.89-1.39-0.89-2.28V4.57c0-0.89,0.29-1.66,0.89-2.28
 c0.59-0.63,1.39-0.94,2.39-0.94h20.3c0.91,0,1.68,0.31,2.32,0.94c0.64,0.63,0.96,1.38,0.96,2.28v31.72c0,0.89,0.29,1.65,0.88,2.28
 c0.58,0.63,1.37,0.94,2.36,0.94h27.82c0.9,0,1.67-0.31,2.3-0.94c0.63-0.63,0.94-1.38,0.94-2.28V4.56c0-0.89,0.29-1.65,0.88-2.28
c0.59-0.63,1.38-0.94,2.37-0.94h20.33c0.9,0,1.67,0.31,2.3,0.94C474.56,2.91,474.88,3.67,474.88,4.57z M520.29,29.29v5.64
 c0,0.9,0.32,1.66,0.95,2.28c0.63,0.63,1.4,0.94,2.3,0.94h36.74c0.9,0,1.67,0.31,2.3,0.94c0.63,0.63,0.95,1.39,0.95,2.28v18.54
 c0,0.9-0.32,1.66-0.95,2.28c-0.63,0.63-1.4,0.94-2.3,0.94h-36.74c-0.9,0-1.67,0.31-2.3,0.94c-0.63,0.63-0.95,1.39-0.95,2.28v5.1
 c0,0.9,0.32,1.66,0.95,2.28c0.63,0.63,1.4,0.94,2.3,0.94h42.16c0.9,0,1.67,0.31,2.3,0.94c0.63,0.63,0.95,1.39,0.95,2.28v18.54
 c0,0.9-0.32,1.66-0.95,2.28c-0.63,0.63-1.4,0.94-2.3,0.94h-69c-0.9,0-1.67-0.31-2.3-0.94c-0.63-0.63-0.95-1.39-0.95-2.28V4.57
 c0-0.89,0.32-1.66,0.95-2.28c0.63-0.63,1.4-0.94,2.3-0.94h69c0.9,0,1.67,0.31,2.3,0.94c0.63,0.63,0.95,1.39,0.95,2.28v18.27
 c0,0.9-0.32,1.66-0.95,2.28c-0.63,0.63-1.4,0.94-2.3,0.94h-42.16c-0.9,0-1.67,0.31-2.3,0.94C520.61,27.63,520.29,28.39,520.29,29.29
 z M586.45,96.46V4.57c0-0.89,0.32-1.66,0.95-2.28c0.63-0.63,1.4-0.94,2.3-0.94h37.01c14.19,0,25.8,4.12,34.84,12.36
 c4.88,4.48,8.59,9.81,11.12,15.99c2.53,6.18,3.8,13.12,3.8,20.82c0,7.7-1.27,14.67-3.8,20.89c-2.53,6.23-6.24,11.58-11.12,16.05
 c-4.52,4.03-9.69,7.08-15.52,9.13c-5.83,2.06-12.27,3.09-19.32,3.09H589.7c-0.9,0-1.67-0.31-2.3-0.94
 C586.77,98.11,586.45,97.35,586.45,96.46z M616.54,74.96h10.17c2.53,0,5.15-0.31,7.86-0.94c2.71-0.63,5.15-1.81,7.32-3.56
 c2.17-1.75,3.95-4.21,5.35-7.39c1.4-3.18,2.1-7.32,2.1-12.43s-0.7-9.25-2.1-12.43c-1.4-3.18-3.21-5.64-5.42-7.39
 c-2.22-1.75-4.66-2.93-7.32-3.56c-2.67-0.63-5.27-0.94-7.79-0.94h-10.17c-0.9,0-1.67,0.31-2.3,0.94c-0.63,0.63-0.95,1.39-0.95,2.28
 v42.18c0,0.9,0.32,1.66,0.95,2.28C614.87,74.65,615.64,74.96,616.54,74.96z M711.44,65.83h-15.05c-1,0-1.81-0.31-2.44-0.94
 c-0.63-0.63-1-1.39-1.08-2.28l-3.39-57.9c-0.09-0.98,0.16-1.77,0.75-2.35c0.59-0.58,1.38-0.87,2.37-0.87h22.64
 c0.9,0,1.65,0.29,2.24,0.87c0.59,0.58,0.83,1.37,0.75,2.35l-3.39,57.9c-0.09,0.9-0.45,1.66-1.08,2.28
 C713.11,65.51,712.34,65.83,711.44,65.83z M714.15,99.68h-20.33c-1,0-1.79-0.31-2.37-0.94c-0.59-0.63-0.88-1.39-0.88-2.28V77.92
 c0-0.98,0.29-1.77,0.88-2.35c0.59-0.58,1.38-0.87,2.37-0.87h20.33c0.9,0,1.67,0.29,2.3,0.87c0.63,0.58,0.95,1.37,0.95,2.35v18.54
 c0,0.9-0.32,1.66-0.95,2.28C715.82,99.37,715.05,99.68,714.15,99.68z"
    ></div>
    <TotalCount :boxTarget="boxTarget" :boxCompleted="boxCompleted" />
  </div>
</template>

<script>
import TotalCount from "./TotalCount";
import ldBar from "@loadingio/loading-bar";
import ky from "ky";
export default {
  components: {
    TotalCount
  },
  sockets: {
    totalFinishedValues(val) {
      this.boxCompleted = val.totalQuantity;
      this.bar.set(this.progress);
    }
  },
  computed: {
    progress() {
      return (this.boxCompleted / this.boxTarget) * 100;
    }
  },
  data() {
    return {
      bar: null,
      boxTarget: 756,
      boxCompleted: 0
    };
  },
  async mounted() {
    const res = await ky
      .get("http://54.169.249.3:8080/getTotalFinished")
      .json();
    this.boxCompleted = res.totalQuantity;
    /* construct manually */
    this.bar = new ldBar("#progressBar", {
      type: "fill",
      "fill-dir": "ltr",
      fill: "#23d160",
      "fill-background": "#F4F4F4",
      "fill-background-extrude": 0,
      "transition-in": 1
    });
    this.bar.set(this.progress);
  },
  methods: {}
};
</script>

<style>
#progressbar-container {
  flex-direction: column;
  border-radius: 5px;
  background: #fff;
  padding: 1rem;
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.23);
}
.is-centered-flex {
  align-items: center;
  justify-content: center;
}
.ldBar-label {
  display: none;
  /* text-align: center;
  font-size: 3rem; */
}
/* .ldBar-label:after {
  content: "%";
  font-size: 2.5rem;
} */
</style>
